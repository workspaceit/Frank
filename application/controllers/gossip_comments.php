<?phpclass gossip_comments extends CI_Controller{    private $u_id;    private $gender;    private $pageData;    private $site_url;    private $sign_in;    private $sign_up;    private $sign_out;    private $search;    private $home;    function __construct()    {        parent::__construct();        $this->load->helper('url');        $this->pageData = array();        include_once(APPPATH . 'controllers/common_site_setting.php');        include_once(APPPATH . 'controllers/load_common_properties_of_user_for_ajax_request_json.php');        $this->sign_in = FALSE;        $this->sign_up = FALSE;        $this->sign_out = TRUE;        $this->search = TRUE;        $this->home = FALSE;    }    function index()    {        include_once(APPPATH . 'controllers/class_file/c_gossip_comments.php');        $c_gossip_comments_obj = new c_gossip_comments();        //$id=trim($this->input->post('id'));        //$gossip_id=trim($this->input->post('gossip_id'));        //$user_id=trim($this->input->post('user_id'));        //$comments=trim($this->input->post('comments'));        //$created_date=trim($this->input->post('created_date'));        $gossip_id = '';        $user_id = '';        $comments = '';        $created_date = '';        $c_gossip_comments_obj->set_gossip_id($gossip_id);        $c_gossip_comments_obj->set_user_id($user_id);        $c_gossip_comments_obj->set_comments($comments);        if ($c_gossip_comments_obj->insert_row_data()) {            echo ';True;';        } else {            echo ';False;';        }    }    function get_user_inf_box_by_comment_id()    {        $this->load->model('m_user_basic_info');        $this->load->model('m_gossip_relationship');        $this->load->model('m_gossip_comment_reply');        $this->load->model('m_gossip_comments');        $this->load->model('m_trait_users_gossip');        $this->load->model('m_gossip_main');        include_once(APPPATH . 'controllers/class_file/encrypt_tbl_primary_key.php');        $repond_array = array();        $encrypt_tbl_primary_key_obj = new encrypt_tbl_primary_key();        if (isset($_REQUEST['gossip_id']) && $_REQUEST['gossip_id'] != "") {            $gossip_id = $encrypt_tbl_primary_key_obj->get_plain_text($_REQUEST['gossip_id']);        } else {            die();        }        $gossip_comments_array = $this->m_gossip_comments->get_all_by_gossip_id($gossip_id);        $comment_user_inf = array();        $comment_text = array();        $comment_like = array();        $comment_user_id = array();        $comment_created_date = array();        $comment_created_time = array();        $comment_id = array();        $comment_reply = array();        $view_reply = array();        $i = 0;        //Have Extract the value here and put it to array        //Because at view the design is column-wise not not row-wise,        //therefore prepareing the data in array to print it in column        foreach ($gossip_comments_array as $rowData) {            $comment_user_inf[$i] = $this->m_user_basic_info->get_j_comment_user_inf_by_u_id($rowData->user_id);            $comment_text[$i] = $rowData->comments;            $comment_like[$i] = $rowData->avg_like;            $comment_user_id[$i] = $rowData->user_id;            $temp_date = new DateTime($rowData->created_date);            $comment_created_date[$i] = $temp_date->format("m/d/Y");            $comment_created_time[$i] = $temp_date->format("H:i A");            $comment_id[$i] = $encrypt_tbl_primary_key_obj->get_encrypted_code($rowData->id);            if (intval($this->u_id) == intval($rowData->user_id)) {                $comment_reply[$i] = false;            } else {                $comment_reply[$i] = true;            }            if ($this->m_gossip_comment_reply->has_reply_by_comment_id($rowData->id)) {                $view_reply[$i] = true;            } else {                $view_reply[$i] = false;            }            $i++;        }        $trait_box = array();        $temp_array = array();        $i = 0;        $j = 0;        $temp_category = "";        foreach ($this->m_trait_users_gossip->get_j_gossip_trait_by_gossip_id($gossip_id) as $rowData) {            if ($temp_category == "") {                $temp_category = $rowData->category;            }            if ($temp_category == $rowData->category) {                $temp_array[$i][0] = $rowData->id;                $temp_array[$i][1] = $rowData->trait_categories_id;                $temp_array[$i][2] = $rowData->category;                $temp_array[$i][3] = $rowData->sub_category_value;                $temp_array[$i][4] = $rowData->sub_category_hidden;                $temp_array[$i][5] = $rowData->sub_category_avg_point;                $temp_array[$i][8] = $rowData->f_point;                $temp_array[$i][9] = $this->u_id;                $temp_array[$i][10] = $rowData->target_id;                if (intval($rowData->sub_category_avg_point) < 0) {                    $temp_array[$i][6] = "i_bar_red";                } else {                    $temp_array[$i][6] = $rowData->color_class;                }                $i++;            } else {                $i = 0;                $trait_box[$j++] = $temp_array;                $temp_array = null;                $temp_category = $rowData->category;                $temp_array[$i][0] = $rowData->id;                $temp_array[$i][1] = $rowData->trait_categories_id;                $temp_array[$i][2] = $rowData->category;                $temp_array[$i][3] = $rowData->sub_category_value;                $temp_array[$i][4] = $rowData->sub_category_hidden;                $temp_array[$i][5] = $rowData->sub_category_avg_point;                $temp_array[$i][8] = $rowData->f_point;                $temp_array[$i][9] = $this->u_id;                $temp_array[$i][10] = $rowData->target_id;                if (intval($rowData->sub_category_avg_point) < 0) {                    $temp_array[$i][6] = "i_bar_red";                } else {                    $temp_array[$i][6] = $rowData->color_class;                }                $i++;            }        }        if ($temp_array != null) {            $trait_box[$j++] = $temp_array;        }        //Gossip Other Inf [Relationship , Indentity Visisbility Fake Score Etc...]        $relation = array();        $relation['relation_ship'] = $this->m_gossip_relationship->get_all_by_gossip_id($gossip_id);        $relation['relation_ship_target_id'] = $this->m_gossip_relationship->get_target_id($gossip_id);        $relation['relation_ship_gossip_id'] = $this->m_gossip_relationship->get_gossipper_id($gossip_id);        $relation['relation_ship_insiders'] = $this->m_gossip_relationship->get_insider_value($gossip_id);        $relation['relation_ship_identity'] = $this->m_gossip_relationship->get_identity_value($gossip_id);        $relation['relation_gen_score'] = $this->m_gossip_relationship->get_gen_score_value($gossip_id);        $relation['relation_ship_user_id'] = $this->u_id;        $relation['encrypt_tbl_primary_key_obj'] = $encrypt_tbl_primary_key_obj;        $this->pageData['gossip_trait_box'] = $trait_box;        $this->pageData['encrypt_tbl_primary_key_obj'] = $encrypt_tbl_primary_key_obj;        $this->pageData['gossip_id'] = $encrypt_tbl_primary_key_obj->get_encrypted_code($gossip_id);        //First Column Data        $this->pageData['comment_user_inf'] = $comment_user_inf;        $this->pageData['comment_created_date'] = $comment_created_date;        $this->pageData['comment_created_time'] = $comment_created_time;        $this->pageData['comment_text'] = $comment_text;        $this->pageData['comment_like'] = $comment_like;        $this->pageData['comment_user_id'] = $comment_user_id;        $this->pageData['comment_id'] = $comment_id;        $this->pageData['comment_reply'] = $comment_reply;        $this->pageData['view_reply'] = $view_reply;        //Second Column Data        $this->pageData['first_col_view'] = true;        $this->pageData['second_col_view'] = false;        $this->pageData['third_col_view'] = false;        $repond_array['first_col'] = $this->load->view("gossip_comment_view", $this->pageData, true);        $this->pageData['gossip_like_equ'] = '54+($e_gossip_like - 1) * 4 + $e_gossip_like';        //Third Column Data        $this->pageData['first_col_view'] = false;        $this->pageData['second_col_view'] = true;        $this->pageData['third_col_view'] = false;        $repond_array['second_col'] = $this->load->view("gossip_comment_view", $this->pageData, true);        $this->pageData['first_col_view'] = false;        $this->pageData['second_col_view'] = false;        $this->pageData['third_col_view'] = true;        $this->pageData['gossiper_id' ]= $this->m_gossip_main->getGossipper_idByTargetId($gossip_id);        $repond_array['thirde_col'] = $this->load->view("gossip_comment_view", $this->pageData, true);        $target = $this->m_gossip_main->is_gossip_target_by_id_target_id($gossip_id, $this->u_id);        $this->pageData['intender'] = $relation;        $repond_array['gossip_trait_boxes'] = $this->load->view("gossip_trait_box_view", $this->pageData, true);        if ($target) {            $repond_array['others'] = $this->load->view("gossip_others_inf", $relation, true);        }else{            $repond_array['others'] = $this->load->view("gossip_others_inf", $relation, true);        }        //old code        /*if ($target) {            $repond_array['gossip_trait_boxes'] = $this->load->view("gossip_trait_box_view", $this->pageData, true);            $repond_array['others'] = $this->load->view("gossip_others_inf", $relation, true);        }*/        echo json_encode($repond_array);    }}?>