<?php/** * Description of user_group * * @property CI_DB_active_reocrd       $db * * @property m_user_login              $m_user_login * @property m_gossip_main             $m_gossip_main * @property m_trait_categories        $m_trait_categories * @property m_trait_users             $m_trait_users * @property m_user_basic_info         $m_user_basic_info * @property m_user_profile_data       $m_user_profile_data * @property m_user_trait_final_values $m_user_trait_final_values * @property m_search                  $m_search * @property m_user_group              $m_user_group * @property m_group_members           $m_group_members * */class group extends CI_Controller {    private $u_id;    private $pageData;    private $site_url;    private $sign_in;    private $sign_up;    private $sign_out;    private $search;    private $home;    function __construct() {        parent::__construct();        $this->load->helper('url');        //$this->load->model('m_user_group');        $this->pageData = array();        include_once(APPPATH . 'controllers/common_site_setting.php');        include_once(APPPATH . 'controllers/class_file/site_url.php');        include_once(APPPATH . 'controllers/class_file/initailize_header_operation.php');        include_once(APPPATH . 'controllers/load_common_properties_of_user.php');        include_once(APPPATH . 'controllers/class_file/encrypt_tbl_primary_key.php');        $this->sign_in = FALSE;        $this->sign_up = FALSE;        $this->sign_out = TRUE;        $this->search = TRUE;        $this->home = FALSE;        //$this->pageData['myGroupList'] = $this->m_user_group->get_grouplist_by_user_id($this->u_id);    }    function index() {        include_once(APPPATH . 'controllers/class_file/c_user_group.php');        $c_user_group_obj = new c_user_group();        //$id=trim($this->input->post('id'));        //$creator_id=trim($this->input->post('creator_id'));        //$name=trim($this->input->post('name'));        //$created_date=trim($this->input->post('created_date'));        $id = '';        $creator_id = '';        $name = '';        $created_date = '';        $c_user_group_obj->set_id($id);        $c_user_group_obj->set_creator_id($creator_id);        $c_user_group_obj->set_name($name);        $c_user_group_obj->set_created_date($created_date);        if ($c_user_group_obj->insert_row_data()) {            echo ';True;';        } else {            echo ';False;';        }    }    public function my_group() {        include_once(APPPATH.'controllers/class_file/Profile/C_Aggrigates.php');        $this->load->model('m_search');        $this->load->model('m_trait_categories');        $this->load->model('m_user_group');        $this->load->model('m_group_members');        $this->load->model('m_gossip_main');        $this->load->model('m_user_basic_info');        $this->load->model('m_user_profile_data');        $c_Aggrigates_obj = new C_Aggrigates();        $temp_inf_array = array();        $temp_inf_array['guest_profile_pic'] = $this->m_user_basic_info->get_pic_path_by_u_id($this->u_id);        $temp_inf_array['guest_name'] = $this->m_user_basic_info->get_name_by_u_id($this->u_id);        $temp_inf_array['guest_location'] = $this->m_user_profile_data->get_current_location_one($this->u_id);        $this->pageData['guest_gossip_reply'] = $temp_inf_array;        $group_name = $this->input->get('gname');        $encryptObj = new encrypt_tbl_primary_key();        $this->pageData['groupName'] = $group_name;        $this->pageData['encryptObj'] = $encryptObj;        $group_id = $this->m_user_group->get_groupid_by_groupname_and_userid($this->u_id, $group_name);        $this->pageData['group_id'] = $encryptObj->get_encrypted_code($group_id);        if (isset($group_id)):            $userList = array();            $userListArray = $this->m_group_members->get_userlist_by_group_id($group_id);            if (isset($userListArray) && !empty($userListArray)):                foreach ($userListArray as $key => $data) {                    $userList[$key] = $data['members_id'];                }                $groupArregates = $c_Aggrigates_obj->getAggregatesInPercentagesByUserList($userList);                $this->pageData['total_member'] = count($userList);                $this->pageData['category_tree'] = $this->m_trait_categories->get_subcategories_in_categories_tree();                $this->pageData['groupTraitListAvg'] = $this->m_search->get_traitlist_avg_by_userlist($userList);                $this->pageData['groupTotalstatus'] = $this->m_search->get_userlist_total_status($userList);                $this->pageData['groupTotalGossipfor'] = $this->m_gossip_main->get_total_gossipfor_by_userlist($userList);                $this->pageData['groupTotalGossipfrom'] = $this->m_gossip_main->get_total_gossipfrom_by_userlist($userList);                $this->pageData['groupTotalGossip'] = $this->m_gossip_main->get_total_gossips_by_userlist($userList);                $this->pageData['top3populer'] = $this->m_search->get_group_top3_populer_by_userlist($userList);                $this->pageData['top2finest'] = $this->m_search->get_group_top2_finest_by_userlist($userList);                $this->pageData['spotLightUser'] = $this->m_search->get_spotlight_user_by_userlist($userList);                $this->pageData['userTraitInfo'] = $this->m_search->get_group_comparison_by_userlist_and_trait($userList, 37);                $this->pageData['latestMember'] = $this->m_search->get_latest_member_from_userlist($userList);                $this->pageData['groupArregates'] =$groupArregates;                $this->pageData['selected_trait'] = 37;                $this->pageData['c_Aggrigates_obj'] = $c_Aggrigates_obj;                $this->load->view('group/group_my_group', $this->pageData);            endif;        else:        endif;    }    public function my_favourites() {        include_once(APPPATH.'controllers/class_file/Profile/C_Aggrigates.php');        $this->load->model('m_search');        $this->load->model('m_trait_categories');        $this->load->model('m_user_group');        $this->load->model('m_group_members');        $this->load->model('m_gossip_main');        $this->load->model('m_user_basic_info');        $this->load->model('m_user_profile_data');        $c_Aggrigates_obj = new C_Aggrigates();        $temp_inf_array = array();        $temp_inf_array['guest_profile_pic'] = $this->m_user_basic_info->get_pic_path_by_u_id($this->u_id);        $temp_inf_array['guest_name'] = $this->m_user_basic_info->get_name_by_u_id($this->u_id);        $temp_inf_array['guest_location'] = $this->m_user_profile_data->get_current_location_one($this->u_id);        $this->pageData['guest_gossip_reply'] = $temp_inf_array;        $group_name = $this->input->get('gname');        $encryptObj = new encrypt_tbl_primary_key();        $this->pageData['groupName'] = $group_name;        $this->pageData['encryptObj'] = $encryptObj;        $group_id = $this->m_user_group->get_groupid_by_groupname_and_userid($this->u_id, $group_name);        $this->pageData['group_id'] = $encryptObj->get_encrypted_code($group_id);        $userListArray = $this->m_group_members->get_favorite_by_user_id($this->u_id);        if(!$userListArray){            redirect(base_url());        }        foreach ($userListArray as $key => $data) {            $userList[$key] = $data['favorited_id'];        }        $groupArregates = $c_Aggrigates_obj->getAggregatesInPercentagesByUserList($userList);        $this->pageData['total_member'] = count($userList);        $this->pageData['category_tree'] = $this->m_trait_categories->get_subcategories_in_categories_tree();        $this->pageData['groupTraitListAvg'] = $this->m_search->get_traitlist_avg_by_userlist($userList);        $this->pageData['groupTotalstatus'] = $this->m_search->get_userlist_total_status($userList);        $this->pageData['groupTotalGossipfor'] = $this->m_gossip_main->get_total_gossipfor_by_userlist($userList);        $this->pageData['groupTotalGossipfrom'] = $this->m_gossip_main->get_total_gossipfrom_by_userlist($userList);        $this->pageData['groupTotalGossip'] = $this->m_gossip_main->get_total_gossips_by_userlist($userList);        $this->pageData['spotLightUser'] = $this->m_search->get_spotlight_user_by_userlist($userList);        $this->pageData['top3populer'] = $this->m_search->get_group_top3_populer_by_userlist($userList);        $this->pageData['top2finest'] = $this->m_search->get_group_top2_finest_by_userlist($userList);        $this->pageData['userTraitInfo'] = $this->m_search->get_group_comparison_by_userlist_and_trait($userList, 37);        $this->pageData['latestMember'] = $this->m_search->get_latest_member_from_userlist($userList);        $this->pageData['groupArregates'] =$groupArregates;        $this->pageData['c_Aggrigates_obj'] = $c_Aggrigates_obj;        $this->pageData['selected_trait'] = 37;        $this->load->view('group/group_my_favorites', $this->pageData);    }    public function remove_favorite_member(){        $this->load->model('m_group_members');        $encryptObj = new encrypt_tbl_primary_key();        $member_id = $encryptObj->get_plain_text($this->input->post('member_id'));        $this->m_group_members->remove_favorite_member($this->u_id,$member_id);        echo 1;    }    public function clear_favorites() {        $this->load->model('m_group_members');        if($this->m_group_members->clear_favorite_member($this->u_id)) {            echo 1;        } else {            echo 0;        }    }    public function update_group_name() {        $this->load->model('m_user_group');        $encryptObj = new encrypt_tbl_primary_key();        $group_name = $this->input->post('group_name');        $group_id = $encryptObj->get_plain_text($this->input->post('group_id'));        if (!$this->m_user_group->check_groupname_by_userid($this->u_id, $group_name)) {            $this->m_user_group->edit_group_name($group_id, $group_name);            echo 1;        } else {            echo 0;        }    }}